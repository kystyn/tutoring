\section{Элементы теории графов}
\subsection{Основные определения}
\begin{definition}
	\textbf{Вершиной} графа будем называть любой объект, который семантически (то есть по смыслу) может быть связан с другой вершиной. Последнее ограничение формально не требуется, оно требуется скорее на начальных этапах освоения теории, чтобы удерживаться в рамках здравого смысла.
\end{definition}
\begin{example}
	Точка на плоскости, телевышка, город могут являться вершинами графа. При этом точка на плоскости будет связываться только с точками на плоскости, но не, скажем, с отрезками. То есть все вершины должны принадлежать одному классу объектов.
\end{example}

\begin{definition}
	\textbf{Ребром} графа будем формально называть пару вершин, принадлежащих данному графу.
\end{definition}
\begin{definition}
	Первую вершину ребра будет называть \textbf{началом}, вторую -- \textbf{концом} ребра.
\end{definition}
\begin{example}
	Пусть \textit{Поросозеро}, \textit{Лахденпохья} -- вершины графа. Тогда пара $\{\textit{Поросозеро}, \textit{Лахденпохья}\}$ -- ребро графа.
\end{example}
\begin{remark} \label{metro}
	Не все возможные пары вершин всегда существуют в виде рёбер! Например, если рассмотреть граф петербургского метрополитена, где в качестве множества вершин берутся все станции петербургского метрополитена, а в качестве множества рёбер -- все существующие перегоны, то не существует, скажем, ребра ``{Ленинский проспект, Московская}'', как, впрочем, и любых рёбер, связывающих несоседние станции (а жаль :(). А такая пара сама по себе существует.
\end{remark}

\begin{remark}
	Обычно рёбра в графе обозначают не абстрактные пары вершин, а несут некоторую смысловую нагрузку (семантику). Так, в приведённом выше примере, рассматривать в качестве множества рёбер множество существующих перегонов -- абсолютно логично, поскольку данный принцип полностью реализуется в реальности и с помощью такого графа можно решать, например, задачи построения самого быстрого пути между станциями или рассчитывать оптимальное количество поездов на линии для обеспечения заданного интервала. Однако такие задачи было бы невозможно решать, если рассмотреть в качестве множества рёбер все пары станций, не соединённых перегонами. Но такой граф будет куда полезнее при создании проекта расширения сети метрополитена с использованием уже имеющихся станций, поскольку позволит более эффективно определять, какие же станции надо соединить новыми перегонами. Первый вариант никак не поможет при решении поставленной задачи.
	
	Вывод: при решении поставленной задачи необходимо формировать граф таким образом, чтобы он позволял наиболее рационально, прозрачно получать доступ к необходимым данным и решать конкретную задачу.
\end{remark}

\begin{definition}
	\textbf{Весом ребра} будем называть число, сопоставляемое ребру графа.
\end{definition}
\begin{example}
	Весом рёбер первого варианта графа петербургского метрополитена из предыдущего примера может служить время преодоления, средняя скорость, длина, уклон перегона (ребра). Опять же, следует правильно выбирать вес исходя из постановки задачи.
\end{example}
\begin{remark}
	В качестве веса графа может использоваться и нечисловой объект. Однако для многих алгоритмов теории графов требуется, чтобы на множестве весов было задано отношение порядка, то есть чтобы любые два веса можно было сравнить и сказать, кто кого больше, меньше или равен.
	
	В принципе, можно привести такой пример графа, однако он скорее всего будет вычурным. Кроме того, любые объекты, на множестве которых задано отношение порядка, можно занумеровать натуральными числами и использовать в качестве весов эти числа (кстати, взаимно-однозначное соответствие двух множеств называется \textbf{изоморфизмом}, а процедура установления изоморфизма множества объектов и отрезка натуральных чисел \textbf{упорядочиванием} этого множества).
\end{remark}

Итак, мы, наконец-то, добрались до определения понятия граф!

\begin{definition}
	\textbf{Графом} $G(V, E)$ называется пара объектов $\{V, E\}$, где $V$ -- множество вершин графа $G$, $E$ -- множеств рёбер графа $G$. Такой граф называется \textbf{невзвешенным}.
\end{definition}
	
\begin{definition}
	\textbf{Графом} $G(V, E, c)$ называется тройка объектов $\{V, E, c\}$, где $V, E$ -- то же, что в первом определении, а $c: \mathbb{E} \rightarrow \mathbb{R (N/Z/Q)}$ -- числовая функция множества рёбер, сопоставляющая каждому ребру вес. Такой граф называется \textbf{взвешенным}.
\end{definition}

\begin{definition}
	\textbf{Путём} в графе называется упорядоченная последовательность рёбер, такая, что рёбра с номерами $n$ и $n + 1$ имеют одинаковый конец и начало соответственно.
\end{definition}
\begin{example}
	В примере \ref{metro} \textit{\{Девяткино, Гражданский проспект, Академическая, Политехническая, Площадь Мужества\}} является путём в графе.
\end{example}

\begin{definition}
	Граф называется \textbf{ориентированным (орграфом)}, если в нём существует хотя бы одно ребро $e = {e_1, e_2}$, что ребра ${e_2, e_1}$ не существует.
\end{definition}

\begin{definition}
	Если же таких рёбер нет, то граф называется \textbf{неориентированным}.
\end{definition}

\begin{example}
	Граф автомобильных дорог в Санкт-Петербурге является ориентированным, поскольку существуют улицы с односторонним движением.
\end{example}
\begin{example}
	Уже до боли знакомый граф пригородного ж/д сообщения Санкт-Петербурга является ориентированным, поскольку по любому перегону движение осуществляется в обе стороны.
\end{example}

\begin{remark}
	Несмотря на интуитивные ощущения, ориентированный граф является более общим случаем, нежели неориентированный: если из данного неориентированного выкидывать последовательно все комбинации рёбер, идущих в одну сторону, и оставлять идущие в другие, то мы получим множество ориентированных графов. То есть из данного неориентированного графа можно породить много ориентированных.
\end{remark}

\begin{definition}
	Две вершины называются \textbf{смежными}, если они соединены ребром в графе.
\end{definition}

\begin{definition}
	\textbf{Степенью вершины} называется количество рёбер, из неё выходящих.
	
	Степень вершины $v$ обозначается $deg v$.
\end{definition}

\begin{definition}
	\textbf{Петлёй} в графе называется ребро, соединяющее вершину с самой собой.
	
	Далее при описании алгоритмов, способов хранения и т. п., если не сказано иное, будем полагать, что граф без петель.
\end{definition}

\subsection{Связность}
\begin{definition}
	Граф называется \textbf{связным}, если между любыми его вершинами существует путь. Если же существует хотя бы одна пара вершин, между которыми невозможно построить путь, то граф называется несвязным.
\end{definition}

\begin{remark}
	Данное понятие используется только для неориентированных графов. Напомню, что понятие ориентированного графа является более общим в том смысле, что неориентированный граф порождает множество ориентированных.
	
	Для орграфов существует понятие сильной и слабой связности (см. \ref{cw_con_g}).
	
	То же самое замечание относится и к понятию \textit{компоненты связности}, которое вводится ниже (см. \ref{cc}, \ref{str_con}, \ref{weak_con}).
\end{remark}

\begin{example}
	Граф петербургского метрополитена \ref{metro} является связным.
\end{example}

\begin{example}
	Граф железнодорожных станций Санкт-Петербурга, в котором множество вершин -- это ж/д станции, а рёбра проводятся в случае наличия пассажирского сообщения, является несвязным, поскольку невозможно добраться на электричке, скажем, от Балтийского вокзала до Витебского.
	
	В то же время, если рёбрами соединяются вершины, между которыми физически проложены принадлежащие РЖД рельсы, но не обязательно осуществляется конкретно \textit{пассажирское} сообщение, то такой граф будет связным -- на территории Санкт-Петербурга нет островных участков железной дороги, подведомственной РЖД!
	
	Данный пример ещё раз показывает необходимость правильного выбора условий для генерации графов под конкретно поставленную задачу.
\end{example}

\begin{definition} \label{cc}
	Граф $G_C$ называется \textbf{компонентой связности} графа $G$, если он является связным графом, все его рёбра содержатся в исходном графе $G$ и при этом нет таких рёбер, у которых один конец принадлежит графу $G_C$, а другой -- нет. То есть если некоторая вершина $v$ принадлежит компоненте связности, то все пути, из неё выходящие, также должны принадлежать компоненте связности.
\end{definition}

\begin{example}
	Все маршруты, по которым идут пригородные поезда с Витебского вокзала (точнее, перегоны, покрываемые такими маршрутами) образуют компоненту связности (граф порождается перегонами, по которым осуществляется пассажирское сообщение). При этом линия ``Витебский вокзал -- Вырица'' не может считаться компонентой связности, поскольку существует, например, путь ``Витебский вокзал -- Новолисино'', который не включён в ``Витебский вокзал -- Вырица''. ``Лишних'' (попавших по ошибке) рёбер также нет, поскольку компонента связности порождается всеми перегонами, \textit{по которым осуществляется пассажирское сообщение} (напомню, рёбра генерируются по такому же принципу). То есть лишних рёбер мы не сделали.
\end{example}

\begin{remark}
	Компонента!!! Не компонент. Дань исторически сложившейся терминологии :)
\end{remark}

\begin{remark}
	Компонент связности в несвязном графе существует как минимум две. Может и больше. Но не меньше. Если компонента связности одна -- значит, граф связный. Это, кстати, альтернативное определение связного графа.
\end{remark}

\begin{remark}
	Компонента связности порождается одной вершиной -- в последнем примере такой вершиной служил Витебский вокзал.
\end{remark}

\begin{example}
	В графе, рёбрами которого являются перегоны, по которым осуществляется пригородное сообщение из Санкт-Петербурга, существует четыре компоненты связности -- первая порождается Витебским вокзалом, вторая -- Балтийским, третья -- Финляндским, четвёртая -- Московским вокзалом (также включает перегоны, по которым идут электропоезда с Ладожского вокзала -- например, путь Мга -- Волховстрой).
\end{example}

\begin{remark}
	Поезд, ходящий с Витебского вокзала в Лугу летом два раза в неделю -- не в счёт :). Можно для точности дополнительно добавить в процедуру построения графа необходимость ежедневного сообщения.
\end{remark}

Для ориентированных графов можно различать сильную и слабую связность.
\begin{definition} \label{str_con}
	\textbf{Компонентой сильной связности} называется компонента связности, являющаяся неориентированным графом.
\end{definition}

\begin{definition} \label{weak_con}
	\textbf{Компонентой слабой связности} называется компонента связности, являющаяся ориентированным графом.
\end{definition}

\begin{definition} \label{cw_con_g}
	Аналогично говорят и про связные графы -- граф является \textbf{сильно связным}, если он является компонентой сильной связности. \textbf{Слабо} -- если компонентой слабой.
\end{definition}

\begin{example}
	На малодеятельных железных дорогах достаточно часто встречается ситуация, когда поезд в одну сторону ходит по одним дням, а в другую -- по другим. Тогда, если граф малодеятельной железной дороги порождается перегонами, по которым в принципе осуществляется пассажирское ж/д сообщение, то он будет являться сильно связным\footnote{Внимательный читатель сейчас задаст резонный вопрос: граф пригородного сообщения Санкт-Петербурга получался несвязным, поскольку, например, поездов между вокзалами нет. Но почему же мы теперь заявляем, что описанный граф сильно связный? 
		
	Дело вот в чём: здесь мы под малодеятельной ж/д неформально понимаем сеть дорог, расходящихся от некоторой узловой станцией. То есть, если бы движение на Витебском направлении Санкт-Петербурга было в десять-пятнадцать раз менее интенсивным, то можно было бы сказать, что Витебский вокзал порождает малодеятельную железную дорогу (более точно -- граф малодеятельной ж/д).

	Безусловно, есть и вполне реальные примеры: станция Бологое-Полоцкое в самом деле порождает малодеятельную ж/д.}. Если же граф порождается, скажем, перегонами, по которым сообщение осуществляется только по понедельникам, то такой граф вообще не будет связным, а почти все его компоненты связности будут являться компонентами слабой связности, и лишь наиболее оживлённые участки порождают компоненты сильной связности.
	
	За конкретным примером можно обратиться скажем, к расписанию, станции Соблаго. Заинтересованный читатель может посмотреть летнее расписание движения поездов ``Соблаго -- Кувшиново'' и ``Бологое -- Великие Луки''.
\end{example}

\subsection{Графическое представление графа}

Часто используется ввиду своей наглядности, а иногда и прямым сходством с поставленной задачей, представление графа, в котором вершины обозначаются точками, а рёбра, их соединяющие -- отрезками. Рядом с вершинами пишутся их названия (номера/города/вышки), а над рёбрами -- веса, в случае наличия таковых. 

TODO: рисунок

\subsection{Представление графов в памяти}

Здесь мы вплотную подбираемся к техническим деталям реализации графов как программных абстракций. Кроме того, представленные в этом разделе сведения помогут лучше понимать условия задач на графы из ЕГЭ.

\subsubsection{Список смежности}
Для каждой вершины $v$ заводится список, размер (мощность) которого совпадает со степенью вершины (то есть размер списка совпадает с количеством исходящих из вершины рёбер). Каждым элементом списка является идентификатор вершины, являющейся концом очередного ребра, выходящего из $v$. В случае, если граф является взвешенным, то кроме конца ребра записывается ещё и вес ребра, то есть формируется список пар <конец ребра, вес ребра>.

Далее формируется список всех списков для каждой вершины. Полученная структура и называется списком смежности.

TODO: пример

\subsubsection{Матрица смежности}

TODO: x -> cross

Составляется таблица (матрица) размером $(|V| + 1) X (|V| + 1)$ .
На первой строчке и в первом  столбце записываются идентификаторы вершин в порядке возрастания (данное требование необязательно. Можно и в любом другом порядке -- главное, чтобы порядок в столбце и в строке совпадал -- тогда можно будет анализировать некоторые важные свойства графа). Далее на пересечении соответствующих строк и столбцов записывается вес ребра, если граф взвешенный, либо просто условный знак (галочка/крестик/единичка), указывающий на наличие ребра между соответствующими вершинами (договоримся здесь, что начало ребра записывается в первом столбце, а конец -- в первой строке, хотя можно и наоборот). Если ребра нет -- ничего не записывается. На главной диагонали, то есть всех клеток с координатами $(n;n)$ также ничего не ставится, поскольку ребра между вершиной $v$ и $v$ нет (если граф без петель). Однако можно поставить и ноль -- во многих задачах будет семантически правильно считать, что вес ``пути'' из $v$ в $v$ равен нулю, то есть что такой путь бесплатный.

\begin{remark}
	Если получившаяся матрица является симметричной относительно главной диагонали, то граф является неориентированным -- оставляю проверку данного факта на острый ум читателя.
\end{remark}

\begin{remark}
	Матрица смежности не годится для хранения графа с петлями, поскольку если есть две петли у одной вершины, то мы не сможем их различить. В то же время список смежности позволит корректно записать обе петли (да и сколько угодно).
\end{remark}

\subsubsection{Список предшествования}

Список предшествования строится по той же методике, что и список смежности, однако для каждой вершины записывается список не \textit{исходящих}, а \textit{входящих} в неё рёбер, то есть список предков.

\subsubsection{Матрица предшествования}

Аналогично строится и матрица предшествования -- на пересечении соответствующей строки и столбца ставится вес ребра (идентификатор его наличия), \textit{входящего} в вершину, указанную в столбце и исходящего из вершины, указанной в строке.

Аналогично можно договориться и поменять местами строку и столбец.

TODO: пример на все виды хранения

\subsubsection{Матрица инцидентности}

\begin{definition}
	Говорят, что вершина и ребро \textbf{инцидентны}, если вершина является началом либо концом ребра.
\end{definition}

\begin{remark}
	Понятие инцидентности вводится для пар ``вершина--ребро'' и является эквивалентным понятием смежности, вводимым для пар ``вершина--вершина''.
\end{remark}

Строится матрица, в которой указываются связи между инцидентными элементами графа (ребро и вершина). Столбцы матрицы соответствуют рёбрам, строки -- вершинам.

На пересечении строки, соответствующей вершине $v$, и столбца, соответствующему ребру $\{v, u\}$, ставится единица. Для пары $u$ и $\{v, u\}$, -- -1.
В случае неориентированного графа допускается в обоих случаях использовать -1, поскольку обычно в неорграфе направление ребра значения не имеет.

Если вершина и ребро неинцидентны, то на пересечении соответствующих столбца и строки ставится ноль.

\begin{remark}
	\begin{itemize}
		\item Матрица инцидентности позволяет описывать графы с петлями.
		\item В каждом столбце обязательно должны стоять не более двух единиц (если это ребро представляет собой петлю, то единица ставится напротив вершины, которой инцидентна петля). В случае ориентированного графа в столбце должны стоять 1 и -1.
	\end{itemize}
\end{remark}

TODO: пример